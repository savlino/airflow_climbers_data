# airflow_climbers_data 'Ingest and Transform DAGs' Project
This project contains Apache Airflow DAGs for data ingestion from local CSVs and transformation using Apache Airflow.

##### Prerequisites
- Python 3.12
- Apache Airflow
- SQLite

##### Setup
**1.	Clone the repository:**
```bash
git clone https://github.com/savlino/airflow_climbers_data.git
cd airflow
```
**2.	Create a virtual environment and activate it:**
```bash
sudo apt-get install python3-pip
sudo apt-get install python3-venv
python -m venv airflow_venv
source airflow_venv/bin/activate
```
**3.	Install the required packages:**
```bash
pip install -r requirements.txt
```
**4.	Set up the Airflow home directory and initialize the Airflow database:**
```bash
export AIRFLOW_HOME=~/airflow
airflow db init
```
**5.	Create admin user (if not exist already):**
```bash
airflow users create --username admin --password admin --firstname FIRST_NAME --lastname LAST_NAME --role Admin --email admin@example.com
```
**6.	Place contents of current project's "/airflow" (/dags, /data, /tests) directory in /home/\<username\>/airflow directory:**

**7.	Start the Airflow web server and scheduler from two separate terminals:**
```bash
airflow webserver --port 8080
airflow scheduler
```
**8.	Access Airflow UI on localhost, using username and password to log-in**
```html
localhost:8080
```
**9.	Run newly imported DAGs from UI**
After successfull completion of DAGs resulting table will be located in local SQLite DB, table 'climbers_transformed'.
Default path is '/tmp/sqlite_default.db'

> Project contains airflow.db file, containing resulting table with transformed data.

##### DAGs
**Data Ingestion DAG**
The sqlite_ingest_dag.py file contains the DAG for ingesting data into local SQLite.
**Data Transformation DAG**
The sqlite_data_transform_dag.py file contains the DAG for transforming data in SQLite.

##### Running Tests
To run the unit tests for the DAGs, use pytest:
pytest tests_airflow.py
##### Configuration
The Airflow configuration is managed in the airflow.cfg file. Adjust the settings as needed for your environment.
##### Data
The /data directory contains the CSV files used in project:
- climber_df.csv
- grades_conversion_table.csv

##### Logs
The /logs directory contains the logs generated by Airflow.
Results of last successfull run included.
##### License
This project is licensed under the MIT License. See the LICENSE file for details.
##### Contact
For any questions or issues, please contact the project maintainer at pavel.krasavin@t-systems.com
